<!DOCTYPE html>
<!--[if lt IE 7]>      <html class="no-js lt-ie9 lt-ie8 lt-ie7"> <![endif]-->
<!--[if IE 7]>         <html class="no-js lt-ie9 lt-ie8"> <![endif]-->
<!--[if IE 8]>         <html class="no-js lt-ie9"> <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js"> <!--<![endif]-->
    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">

        <title>Probabilistic Memory Retrieval.</title>
        <meta name="description" content="Classification of Drug Like molecules using Artificial Neural Network">
        <meta name="keywords" content="">

        <!-- Mobile viewport -->
        <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

        <link rel="shortcut icon" href="images/favicon.ico"  type="image/x-icon">

        <!-- CSS-->
        <!-- Google web fonts. You can get your own bundle at http://www.google.com/fonts. Don't forget to update the CSS accordingly!-->
        <link href='http://fonts.googleapis.com/css?family=Droid+Serif|Ubuntu' rel='stylesheet' type='text/css'>

        <link rel="stylesheet" href="css/normalize.css">
        <link rel="stylesheet" href="js/flexslider/flexslider.css">
        <link rel="stylesheet" href="css/colorblocks-style.css">

        <!-- end CSS-->

        <!-- JS-->
        <script src="js/libs/modernizr-2.6.2.min.js"></script>
        <!-- end JS-->

    </head>

    <body id="home">


        <!-- header area -->
        <header class="wrapper clearfix">

            <div id="banner">        
                <div id="logo"><a href="index.html"><img src="images/logo.png" alt="logo"></a></div> 
            </div>

            <!-- main navigation -->
            <nav id="topnav" role="navigation">
                <div class="menu-toggle">Menu</div>  
                <ul class="srt-menu" id="menu-main-navigation">
                    <li ><a href="index.html">Home page</a></li>            
                    <li class="current"><a href="#">Projects</a>
                        <ul>
                            <li>
                                <a href="drugai.html">DrugAI</a>
                                <ul>
                                    <li><a href="drugai-gen.html">DrugAI-gen</a></li>
                                    <li><a href="drugai-gan.html">DrugAI-GAN</a></li>
                                </ul>
                            </li>
                            <li>
                                <a href="proteinstatai.html">ProteinStatsAI</a>
                            </li>
                            <li>
                                <a href="multi_task.html">BrainGAN</a>
                            </li>
                            <li>
                                <a href="nerd.html">NERD</a>
                            </li>
                            <li class="current">
                                <a href="prob_retrieval.html">Probabilistic Memory Retrieval</a>
                            </li> 
                            <li>
                                <a href="#">Others</a>
                                <ul>
                                    <li><a href="https://gist.github.com/Gananath/5b2f4640fdf96cd87a81a4206a0d3fe8">Kaggle</a></li>
                                    <li><a href="#">menu item 3.2.2 with longer link name</a></li>
                                    <li><a href="#">menu item 3.2.3</a></li>
                                    <li><a href="#">menu item 3.2.4</a></li>
                                    <li><a href="#">menu item 3.2.5</a></li>
                                </ul>
                            </li>                           
                        </ul>
                    </li>
                    <li>
                        <a href="cv.html" target="_blank">CV</a>
                    </li>
                    <li>
                        <a href="#">Contact</a>
                        <ul>
                            <li><a href="javascript: void(0)"
 onclick="return confirm('Msg me in github or reddit, preferably both.');">E-Mail</a></li>	
                            <li><a href="https://github.com/Gananath">GitHub</a></li>	
                            <li><a href="#">Facebook</a></li>	
                            <li><a href="#">Twitter</a></li>	
                        </ul>
                    </li>
                </ul>     
            </nav><!-- end main navigation -->

        </header><!-- end header -->



        <!-- hero area (the grey one with a slider -->
        <section id="page-header" class="clearfix">    

            <div class="wrapper">
                <h1>Probabilistic Memory Retrieval</h1>
                <h4>A proof of concept in probabilistic retrival of memory using neural networks.</h4>
            </div>
        </section><!-- end hero area -->





        <!-- main content area -->   

        <div id="main" class="wrapper clearfix">    

            <!-- content area -->    
            <section id="content">
                <center><img src="images/pm/pm_.jpg" alt="probabilistic_model" style="width:550px;height:150px;"> </center>
                <p><b>Introduction</b></p>
                <p> This idea came into existance after reading the article written by Jay Alammar on RETRO model <a href="https://jalammar.github.io/illustrated-retrieval-transformer/">The Illustrated Retrieval Transformer</a>. Its a small but intuitively written post about RETRO model and how it work. Its highly recommend that you read it before continuing this post.</p>

                <p>Basic idea of retro model can be summarized into 5 steps
                <ol>
                    <li>Get a text query.</li>
                    <li>Pass the query to a pre-trained model like BERT which ouptut its embeddings. </li>
                    <li>This embedding vector is used for fetching 'n' number of similar/neigbour textual chunks from a key-value database.</li>
                    <li>The retrieved 'n' textual chunks were used to train the RETRO model.</li>
                    <li>The trained RETRO model along with the BERT is used to predict the answers.</li>
                </ol>
                The advantage of this type of training is, a small model with fewer number of parameters can outperform a very large model. Because of lesser number of parameters, its training and inference will also be faster. 
                 </p>
                
                <p><b>Hypothesis/Idea</b></p>
                <p>In the original RETRO paper the authors have used BERT+DATBASE to retrieve  additonal information, that is, step:1 - step:3 to train a RETRO model. My idea is to combine the step:1 through step:3 and approximate it into a probabilistic model. Instead of retriving similar/neigbour chunks from database we sample from this probabilistic model to get similar/neigbouring low dimensional latent vectors. We then use this latent vectors to train a RETRO like MLP model. The idea is, the probabilistic model will act like a memory reservoir for storing data and the MLP will fetch additional data from this reservoir to predict an output. The <b><i>assumption</i></b> is that instead of using a single input the additonal retrived neigbouring vectors will help the model to give more generalized/accurate output without using a large database.</p>
                
                <center><img src="images/pm/pm1.jpg" alt="probabilistic_model" style="width:350px;height:100px;"> </center>  
                
                <p><b>Building probablisitc memory retrieval model</b></p>
                <p>The orginal RETRO paper was trained in textual data. Because of contstraint in resources we opted to use MNIST image data to train this memory retriving plus classification model.  In this project a Variational AutoEncoder (VAE) was chosen as the probabilistic model,other probabilistic model should also work given we can sample some latent vectors. The VAE model was not built by myself, I have used  <a href="https://github.com/Jackson-Kang/Pytorch-VAE-tutorial/blob/master/01_Variational_AutoEncoder.ipynb">Jackson Kang's VAE Model</a> with slight modifications in latent diminesion.</p>
                
                <p><b>Model training</b></p>
                <p>
                First the VAE was pre-trained with MNIST data.From this pre-trained VAE model; for an image we can fetch its mean and variance from encoder. Using this mean and variance we can sample 'n' latent vectors(ours n=10) using the below formula, here N is the Normal Distribution.
                 <center><img src="images/pm/pm2.jpg" alt="" style="width:300px;height:60px;"> </center>  
                 The 'n' latent vectors generated were used as an input to train a MLP classifer. For calculating latent vectors; mean vector was multiplied with an alpha (N(1,0.5)), this was done to add stochasticity inorder to sample from neigbouring vectors.
                </p>

                <p><b>Result</b></p>
                <p>
                 For a batch size of 1, this model was trained in pytorch with SGD as optimizer and CrossEntropy as loss function. Of the tens of thousands of MNIST images, we have only used hundred images for training and 50 images for testing. The model has been trained for about 1000 plus epochs. In the end our training average loss were about 0.8xxx ish and train accuracy was about 73%. But sadly the testing accuracy hover between 8 and 14%. The lower testing accuracy might be due to training the models with fewer data(100 images). I had to train my models in a lower end cpu which cannot handle a model training with full mnist data.  The testing and training accuracy might improve on increasing the number of images. I have planned to use google colab for training but I am facing this weird problem in colab, in which it blocks upload of any files in MB. Sadly I am not able to train this model in a GPU machine thus unable to optimize this idea fully. 
                </p>
                
                <p>Project Github Page: <a href="https://github.com/Gananath/probablistic_memory_retrieval">https://github.com/Gananath/probablistic_memory_retrieval</a></p>
                <br>

            </section><!-- #end content area -->


            <!-- sidebar -->    
            <aside>
                <h2>Navigation</h2>
                <nav id="secondary-navigation">
                    <ul>
                        <li><a href="index.html">Home Page</a></li>
                        <li class="current"><a href="prob_retrieval.html">Probabilistic Memory Retrieval</a></li>
                        <li><a href="nerd.html">NERD</a></li>
                        <li><a href="drugai.html">DrugAI</a></li>                        
                        <li><a href="proteinstatai.html">ProteinStatsAI</a></li>
                        <li><a href="multi_task.html">BrainGAN</a></li>
                        <li><a href="cv.html">CV</a></li>
                        <li><a href="https://github.com/Gananath">Contact</a></li>

                    </ul>
                </nav>
            </aside><!-- #end sidebar -->



        </div><!-- #end div #main .wrapper -->





        <!-- footer area -->    
        <footer>
            <div id="colophon" class="wrapper clearfix">
                footer stuff
            </div>

            <!--You can NOT remove this attribution statement from any page, unless you get the permission from prowebdesign.ro--><div id="attribution" class="wrapper clearfix" style="color:#666; font-size:11px;">Site built with <a href="http://www.prowebdesign.ro/simple-responsive-template/" target="_blank" title="Simple Responsive Template is a free software by www.prowebdesign.ro" style="color:#777;">Simple Responsive Template</a></div><!--end attribution-->

        </footer><!-- #end footer area --> 


        <!-- jQuery -->
        <script src="http://ajax.googleapis.com/ajax/libs/jquery/1/jquery.min.js"></script>
        <script>window.jQuery || document.write('<script src="js/libs/jquery-1.9.0.min.js">\x3C/script>')</script>

        <script defer src="js/flexslider/jquery.flexslider-min.js"></script>

        <!-- fire ups - read this file!  -->   
        <script src="js/main.js"></script>

    </body>
</html>
