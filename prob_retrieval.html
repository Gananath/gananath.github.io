<!doctype html>
<html lang="en">
  <head>
    <!-- Required meta tags -->
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <!-- Bootstrap CSS -->
    <link href="./css/custom_bootstrap.css" rel="stylesheet">

    <title>Probabilistic Memory Retrieval.</title>
    <meta name="description" content="Classification of Drug Like molecules using Artificial Neural Network">
  
  <style>
      .custom-btn {
            width: 17em !important;
        }
        .nav-link:visited,
            .nav-link:link {
              border-bottom: 2px solid transparent;
            }

        .nav-link:hover,
        .nav-link:active {
          border-bottom: 2px solid #1bcfc6;
        }
  </style>
  </head>
  <body>
    <!-- Option 1: Bootstrap Bundle with Popper -->
    <script src="./js/bootstrap.bundle.min.js"></script>
    
    <!-- Header -->
    <div class="container px-2 border-bottom">
    <nav class="navbar navbar-expand-lg navbar-light">
        <a class="navbar-brand btn btn-outline-primary p-2 lead text-dark" href="index.html" role="button">Gananath R</a>
        <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarSupportedContent" aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
          <span class="navbar-toggler-icon"></span>
        </button>
        <div class="collapse navbar-collapse justify-content-end" id="navbarSupportedContent">
          <ul class="navbar-nav  ml-auto mb-2 mb-lg-0 lead px-2">
            <li class="nav-item">
              <a class="nav-link active" aria-current="page" href="index.html">Home</a>
            </li>
            <li class="nav-item dropdown ">
              <a class="nav-link dropdown-toggle" href="#" id="navbarDropdown" role="button" data-bs-toggle="dropdown" data-bs-auto-close="outside">
                Projects
              </a>
              <ul class="dropdown-menu" aria-labelledby="navbarDropdown">
              <li class="dropstart">
                  <a class="dropdown-item dropdown-toggle" data-bs-toggle="dropdown" href="drugai.html">DrugAI
                </a>
                  <ul class="dropdown-menu">
                      <li><a class="dropdown-item" href="drugai.html">DrugAI</a></li>
                      <li><a class="dropdown-item" href="drugai-gen.html">DrugAI-gen</a></li>
                      <li><a class="dropdown-item" href="drugai-gan.html">DrugAI-GAN</a></li>
                  </ul>
              </li>
                <li><a class="dropdown-item" href="proteinstatai.html">ProteinStatsAI</a></li>
                <li><a class="dropdown-item" href="multi_task.html">BrainGAN</a></li>
                <li><a class="dropdown-item" href="nerd.html">NERD</a></li>
                <li><a class="dropdown-item" href="prob_retrieval.html">Probabilistic Memory Retrieval</a></li>
                <li><hr class="dropdown-divider"></li>
                <li><a class="dropdown-item" href="https://gist.github.com/Gananath/5b2f4640fdf96cd87a81a4206a0d3fe8">Other</a></li>
              </ul>
            </li>
            <li class="nav-item">
              <a class="nav-link" href="cv.html">CV</a>
            </li>
            
            <li class="nav-item dropdown">
              <a class="nav-link dropdown-toggle" href="#" id="navbarDropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
                Contacts
              </a>
              <ul class="dropdown-menu" aria-labelledby="navbarDropdown">
                <li><a class="dropdown-item" href="#" onclick="return confirm('Msg me in github or reddit, preferably both.');">E-Mail</a></li>
                <li><a class="dropdown-item" href="https://github.com/Gananath">GitHub</a></li>
                <li><a class="dropdown-item" href="#">Facebook</a></li>
                <li><a class="dropdown-item" href="#">Twitter</a></li>
                </ul>
            </li>
            
          </ul>
        </div>
    </nav>
    </div>
  
  <!-- body -->
  <div class="container">
      
        <div class="row bg-light text-dark p-4 rounded">
        <h1 class="display-5">Probabilistic Memory Retrieval</h1>
        <h5 class="lead">A proof of concept in probabilistic retrival of memory using neural networks.</h5>
        </div >
      
       <div class="row pt-4">
           <!-- content -->
          <div class="col-sm-9 border text-secondary rounded p-4 ">
             <center><img src="images/pm/pm_.jpg" alt="probabilistic_model" style="width:550px;height:150px;"> </center>
                <h1 class="display-6 py-2">Introduction</h1>
                <p> This idea came into existance after reading the article written by Jay Alammar on RETRO model <a href="https://jalammar.github.io/illustrated-retrieval-transformer/">The Illustrated Retrieval Transformer</a>. Its a small but intuitively written post about RETRO model and how it work. Its highly recommend that you read it before continuing this post.</p>

                <p>Basic idea of retro model can be summarized into 5 steps
                <ol>
                    <li>Get a text query.</li>
                    <li>Pass the query to a pre-trained model like BERT which ouptut its embeddings. </li>
                    <li>This embedding vector is used for fetching 'n' number of similar/neigbour textual chunks from a key-value database.</li>
                    <li>The retrieved 'n' textual chunks were used to train the RETRO model.</li>
                    <li>The trained RETRO model along with the BERT is used to predict the answers.</li>
                </ol>
                The advantage of this type of training is, a small model with fewer number of parameters can outperform a very large model. Because of lesser number of parameters, its training and inference will also be faster. 
                 </p>
                
                <h1 class="display-6 py-2">Hypothesis/Idea</h1>
                <p>In the original RETRO paper the authors have used BERT+DATBASE to retrieve  additonal information, that is, step:1 - step:3 to train a RETRO model. My idea is to combine the step:1 through step:3 and approximate it into a probabilistic model. Instead of retriving similar/neigbour chunks from database we sample from this probabilistic model to get similar/neigbouring low dimensional latent vectors. We then use this latent vectors to train a RETRO like MLP model. The idea is, the probabilistic model will act like a memory reservoir for storing data and the MLP will fetch additional data from this reservoir to predict an output. The <b><i>assumption</i></b> is that instead of using a single input the additonal retrived neigbouring vectors will help the model to give more generalized/accurate output without using a large database.</p>
                
                <center><img src="images/pm/pm1.jpg" alt="probabilistic_model" style="width:350px;height:100px;"> </center>  
                
                <h1 class="display-6 py-2">Building probablisitc memory retrieval model</h1>
                <p>The orginal RETRO paper was trained in textual data. Because of contstraint in resources we opted to use MNIST image data to train this memory retriving plus classification model.  In this project a Variational AutoEncoder (VAE) was chosen as the probabilistic model,other probabilistic model should also work given we can sample some latent vectors. The VAE model was not built by myself, I have used  <a href="https://github.com/Jackson-Kang/Pytorch-VAE-tutorial/blob/master/01_Variational_AutoEncoder.ipynb">Jackson Kang's VAE Model</a> with slight modifications in latent diminesion.</p>
                
                <h1 class="display-6 py-2">Model training</h1>
                <p>
                First the VAE was pre-trained with MNIST data.From this pre-trained VAE model; for an image we can fetch its mean and variance from encoder. Using this mean and variance we can sample 'n' latent vectors(ours n=10) using the below formula, here N is the Normal Distribution. For calculating latent vectors; mean vector was multiplied with an alpha (N(1,0.5)), this was done to add stochasticity inorder to sample from neigbouring vectors.
                 <center><img src="images/pm/pm2.jpg" alt="" style="width:300px;height:60px;"> </center>  
                 The 'n' latent vectors generated were used as an input to train a MLP classifer. We have used latent vectors to train the MLP instead of the generated images from VAE due of its lesser number of dimensions. The lower dimensional latent vector encodes the important features and it also helps in faster training and inference. Another hypothetical reason for choosing the latent vector is that we beileve brain encodes and stores informations in smaller dimensions. Everyday, Everytime human brain is bombarded with signals from various analog sensory inputs such eye, ear, skin etc. Human brain is a finite storarge machine and it will unlikely store all these higher dimensonal inputs from these sensors as raw data. Its more advantageous to store memories in lower dimensions and retrieve those memories probablistically. 
                </p>

                <h1 class="display-6 py-2">Result</h1>
                <p>
                 For a batch size of 1, this model was trained in pytorch with SGD as optimizer and CrossEntropy as loss function.I have trained it for 3 epochs using MNIST full data and the last results are. 
                   <ol>

                       <li>Training Accuracy: <b>74%</b></li>

                    <li>Testing Accuracy: <b>73%</b></li>



                </ol>
                </p>
                
                <p>Project Github Page: <a href="https://github.com/Gananath/probablistic_memory_retrieval">https://github.com/Gananath/probablistic_memory_retrieval</a></p>
                <br>

          </div>
          
           <!-- Sidebar -->
          <div class="col-sm-3 bg-light">

                <a href="index.html"  class="btn btn-primary btn-block custom-btn mt-1 text-light" role="button">Home</a>
                <a href="prob_retrieval.html"  class="btn btn-outline-primary text-secondary  btn-block custom-btn mt-1 " role="button">Probabilistic Memory Retrieval</a>
                <a href="nerd.html"  class="btn btn-primary btn-block custom-btn mt-1 text-light" role="button">NERD</a>
                <a href="drugai.html"  class="btn btn-primary btn-block custom-btn mt-1 text-light" role="button">DrugAI</a>
                <a href="proteinstatai.html"  class="btn btn-primary btn-block custom-btn mt-1 text-light" role="button">ProteinStatsAI</a>
                <a href="multi_task.html"  class="btn btn-primary btn-block custom-btn mt-1 text-light" role="button">BrainGAN</a>
                <a href="cv.html"  class="btn btn-primary btn-block custom-btn mt-1 text-light" role="button">CV</a>
                <a href="https://github.com/Gananath"  class="btn btn-primary btn-block custom-btn mt-1 text-light" role="button">Contact</a>


          
          </div>
        </div> 
    
  </div>
    
   <!-- Footer -->
    <div class="container mt-4 border-top bg-primary rounded-bottom">
      <footer class="py-3 my-4">
        <ul class="nav justify-content-center border-bottom pb-3 mb-3">
          <li class="nav-item"><a href="#" class="nav-link px-2 text-light">Footer</a></li>
        </ul>
        <p class="text-center text-light">© 2022 Made by Me</p>
      </footer>
    </div>

  </body>
</html>
