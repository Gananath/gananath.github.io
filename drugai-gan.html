<!doctype html>
<html lang="en">
  <head>
    <!-- Required meta tags -->
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <!-- Bootstrap CSS -->
    <link href="./css/custom_bootstrap.css" rel="stylesheet">
    <title>DrugAI-GAN.py: Experiments with GAN for drug like molecule generation</title>
    <meta name="description" content="Experiments with GAN for drug like molecule generation">
  
  <style>
      .custom-btn {
            width: 17em !important;
        }
        .nav-link:visited,
            .nav-link:link {
              border-bottom: 2px solid transparent;
            }

        .nav-link:hover,
        .nav-link:active {
          border-bottom: 2px solid #1bcfc6;
        }
  </style>
  </head>
  <body>
    <!-- Option 1: Bootstrap Bundle with Popper -->
    <script src="./js/bootstrap.bundle.min.js"></script>
    
    <!-- Header -->
    <div class="container px-2 border-bottom">
    <nav class="navbar navbar-expand-lg navbar-light">
        <a class="navbar-brand btn btn-outline-primary p-2 lead text-secondary" href="index.html" role="button">Gananath R</a>
        <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarSupportedContent" aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
          <span class="navbar-toggler-icon"></span>
        </button>
        <div class="collapse navbar-collapse justify-content-end" id="navbarSupportedContent">
          <ul class="navbar-nav  ml-auto mb-2 mb-lg-0 lead px-2">
            <li class="nav-item">
              <a class="nav-link active" aria-current="page" href="index.html">Home</a>
            </li>
            <li class="nav-item dropdown ">
              <a class="nav-link dropdown-toggle" href="#" id="navbarDropdown" role="button" data-bs-toggle="dropdown" data-bs-auto-close="outside">
                Projects
              </a>
              <ul class="dropdown-menu" aria-labelledby="navbarDropdown">
              <li class="dropstart">
                  <a class="dropdown-item dropdown-toggle" data-bs-toggle="dropdown" href="drugai.html">DrugAI
                </a>
                  <ul class="dropdown-menu">
                      <li><a class="dropdown-item" href="drugai.html">DrugAI</a></li>
                      <li><a class="dropdown-item" href="drugai-gen.html">DrugAI-gen</a></li>
                      <li><a class="dropdown-item" href="drugai-gan.html">DrugAI-GAN</a></li>
                  </ul>
              </li>
                <li><a class="dropdown-item" href="proteinstatai.html">ProteinStatsAI</a></li>
                <li><a class="dropdown-item" href="multi_task.html">BrainGAN</a></li>
                <li><a class="dropdown-item" href="nerd.html">NERD</a></li>
                <li><a class="dropdown-item" href="prob_retrieval.html">Probabilistic Memory Retrieval</a></li>
                <li><hr class="dropdown-divider"></li>
                <li><a class="dropdown-item" href="https://gist.github.com/Gananath/5b2f4640fdf96cd87a81a4206a0d3fe8">Other</a></li>
              </ul>
            </li>
            <li class="nav-item">
              <a class="nav-link" href="cv.html">CV</a>
            </li>
            
            <li class="nav-item dropdown">
              <a class="nav-link dropdown-toggle" href="#" id="navbarDropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
                Contacts
              </a>
              <ul class="dropdown-menu" aria-labelledby="navbarDropdown">
                <li><a class="dropdown-item" href="#" onclick="return confirm('Msg me in github or reddit, preferably both.');">E-Mail</a></li>
                <li><a class="dropdown-item" href="https://github.com/Gananath">GitHub</a></li>
                <li><a class="dropdown-item" href="#">Facebook</a></li>
                <li><a class="dropdown-item" href="#">Twitter</a></li>
                </ul>
            </li>
            
          </ul>
        </div>
    </nav>
    </div>
  
  <!-- body -->
  <div class="container">
      
        <div class="row bg-light text-dark p-4 rounded">
        <h1 class="display-5">DrugAI-GAN</h1>
        <h5 class="lead">Experiments with GAN for drug like molecule generation.</h5>
        </div >
      
       <div class="row pt-4">
             <!-- content -->
          <div class="col-sm-9 border text-secondary rounded p-4 ">
            <p><a href="https://github.com/Gananath/DrugAI/tree/master/DrugAI-WGAN">DrugAI-WGAN</a> : A Wasserstein GAN model with CNN; this model currently trains the fastest and probably gives the best result. Result is at the bottom of the page.</p>
                <p>If you are visiting here for the first time then I would recommend you to my earlier project <a href="https://github.com/Gananath/DrugAI">DrugAI</a> before reading any further. The main aim of this project was to carry out some personal experiments with Generative adversarial networks (GAN) for sequence generation. GAN's were discoverd by Ian Goodfellow  in 2014 for image generation. It has revolutinized the way images are generated using machines and there are currently many research groups around the world involved in this algorithm. GANs are so diverse that there are various types of GANs such as stackGAN, cycleGAN, infoGAN, dcGAN, pix2pix etc created by researchers. I would also recommend you to go through those projects and see for yourself the sureal images created by GANs. </p>
                
                <img src="https://pbs.twimg.com/media/C8QDETuUwAE0vIl.jpg" class="img-fluid mx-auto d-block" alt="cycleGAN" >
    
                <p>In my previous sub-project of DrugAI  I have used a <a href="https://gananath.github.io/drugai-gen.html">LSTM model</a> for generating drug like molecules. I wanted to see weather these kind of molecules can also be generated using GANs. While searching for the possible applications of GAN in text generation; I came across a reddit post by  <a href="https://www.reddit.com/r/MachineLearning/comments/40ldq6/generative_adversarial_networks_for_text/cyyp0nl/">Ian Goodfellow </a>himself. According to him and an another research paper, its very hard to teach GAN in a discrete dataset. As sequence generation involves discrete data it would be very hard to generate any meaning ful sequence from it. This project is just an experiment to see for myself; what happens if GAN is used for sequence generation.</p>
                
                <p>Most of the code for this project I salvaged from my earlier <a href="https://gananath.github.io/drugai-gen.html">LSTM model project</a> and added an additional GAN model to it. The GAN model was prepared using the codes and recommendations from the web articles freely available in the web and I am in no way guaranteing its accuracy. Instead of using a gaussian noise as input, I chose my earlier LSTM model's one hot encoded <kbd>x</kbd> values as the input (<i>z</i>). I already trained GAN with gaussian inputs and what I observed in my initially 1000 epochs training was that GAN's for sequence generation tends to learn faster with one hot encoded inputs than the gaussian inputs. </p>

                <p> Because I have a very old system, training deep learning algorithms for longer duration is not possible in it. I recently came across <a href="https://floydhub.com">floydhub.com</a> which has a free trial period for training deep learning models using either gpu or cpu. I know about AWS cloud system and their free tier for deep learning but it requires a submission of credit card or bank account details which I am not comfortable with. This is the first time I am using a cloud server for training deep learning projects and so far I am impressed by <b>floydhub</b> and its support. The web interface is very simple and eventhough being a first time user I can easily deploy my projects in floydhub with ease. Initially their were some hiccups but support was extraordinary and fast.</p>
                
               I deployed my GAN project this way in floydhub
               
                    <ul>
<li>
<p>Download <strong>DrugAI-GAN.py</strong> and <strong>stahl.csv</strong> dataset from github</p>
</li>
<li>
<p>Copy and save those files inside a new folder with name <strong>DrugAI</strong></p>
</li>
<li>
<p>Install floydhub command line tool <strong>$ pip install -U floyd-cli</strong></p>
</li>
<li>
<p>Login to floyd hub <strong>$ floyd login</strong></p>
</li>
<li>
<p>From shell <em>CD</em> and go to <strong>DrugAI</strong> folder</p>
</li>
<li>
<p>Initilaze a new project <strong>$ floyd init </strong><strong>DrugAI-GAN</strong></p>
</li>
<li>
<p>Run this code <strong>$ floyd run "python </strong><strong>DrugAI-GAN</strong><strong>.py"</strong></p>
</li>
    </ul>
           <p>Even with a cloud service like floydhub, it has been taking me more than a day in cpu to train with complete dataset. In free tier a project will automatically time out after 24 hours in floydhub, which is a current limitation of this service. Instead of using complete dataset(>300 rows) I used only 30 rows. This allowed me to train my model for more epochs and thus refine my model.</p>
            <kbd>INPUT</kbd>
            <blockquote class="blockquote"> 
                <p>[[0,0,0,1,0,0],[0,1,0,0,0,0],[0,0,0,0,0,1]]</p>
            </blockquote>
            <kbd>EPOCH: 0</kbd>
            <blockquote class="blockquote"> 
        <p>
            ['NNNNNNNNN33333NNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNN',
             'P5555lllll[[[[[[[[|||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||',
             '===BBBBBBBBBBBBBBBBBBB===============================================rrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrr']</p>
             
             </blockquote>
             <kbd>EPOCH: 3000+</kbd> 
                <p>
                    ['CCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCC||||||||||||||||||||||||||||||||||||||||||'
                     'CCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCC|||||||||||||||||||||||||||||||||||||'
                     'CCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCC|||||||||||||||||||||||||']</p>
                
                <p>The end result seems intersting but as many in the <a href="https://www.reddit.com/r/MachineLearning/comments/40ldq6/generative_adversarial_networks_for_text/cyyp0nl/">reddit discussion </a> suggested that GAN may learn somethings from the dataset but mostly the output can be rubbish. Even with a dropout layer I am worried that the end result may be caused by overfitting of data.</p>

                <p><kbd>UPDATE: </kbd>I have trained it for a little longer (a day to be exact) and it seems GAN learns only a single sequence. Whatever the input I gave to it, the output was always the same and its a well know problem in GAN called as "mode collapse". In order to prevent mode collapse I have retrained Discriminator using a artificial noise data and so far the result is interesting.</p>
                
                <kbd>EPOCH: 6000+</kbd> 
                <blockquote class="blockquote"> 
                <p>
                    ['CC1NNNNNNNNNNNCCCCCCCCCCCC====CCCCCCC||||||||||||||||||||||||||||||||||||||||||||||||||||'
                     'CC1NNNNNNNNCCCCCCCCCCCNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNN111111111111111111111'
                     'CC1NNNNNNNNNCCCCCCCCCCCNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNNN111111111111111111111']
</p></blockquote>
                <p>May be training it for longer epochs, more data and optimaizing learning rate of generator and discriminator will produce more realistic drug molecules.</p>

                <p>Instead of predicting single molecule per class we can also generate seperate molecules from same class. For example if 
                    I want to generate a molecule from first class instead of giving one hot encoded discrete values I can give it continous values.            
                
                </p>
                
                <h1 class="display-6 py-2">RESULT</h1> 
                <h5>DrugAI-GAN</h5> 
                
                <kbd>INPUT: [[0.6,0,0,0,0,0],[0.3,0,0,0,0,0],[0.7,0,0,0,0.0]]</kbd>
                <blockquote class="blockquote"> 
                ['CCNNNNNNNNNNNCCCCCCC====CCCCCCC||||||||||||||||||||||||||||||||||||||||||||||||||||||||||'
                 'CCNNNNNNNNNNNNCCCCCCCC====CCCCCCC||||||||||||||||||||||||||||||||||||||||||||||||||||||||'
                 'CCNNNNNNNNNNNCCCCCCC====CCCCCCC||||||||||||||||||||||||||||||||||||||||||||||||||||||||||']
                
                </blockquote>
                <p>Project Github Page: <a href="https://github.com/Gananath/DrugAI/blob/master/DrugAI-GAN.py">https://github.com/Gananath/DrugAI/blob/master/DrugAI-GAN.py</a></p>
                <p>FloydHub logs: <a href="https://github.com/Gananath/DrugAI/blob/master/Others/Logs/floydlogs_gan.txt">https://github.com/Gananath/DrugAI/blob/master/Others/Logs/floydlogs_gan.txt</a></p>
                <h5>DrugAI-WGAN</h5><p>(updated on Aug 3 2017)</p>
                <kbd>INPUT: [[0, 0, 0, 1, 0, 0],[0, 1, 0, 0, 0, 0],[0, 0, 0, 0, 0, 1]]</kbd>
                 <blockquote class="blockquote"> <p>
                ['CC1=C(C(C(=O)O)(=CC=N2[S]CCCCCC(C(Cl)C1C4)[+])C2=C4=O|||||||||||||||||||||||||||'
                 'CC1=C(C(C(=O)OO(=CC=N2[N]CCCCCC(C(Cl)C1C3)[+])C2=CC=O)||||||||||||||||||||||||||'
                 'CC1=C(C(C(=O)O)(=CC=N2[N]CCC=CC(C(CO)C1C3)[+])C2=CC=O)||||||||||||||||||||||||||']
                </p>
                    </blockquote>
                <p><i>*After training for 1 hour in GPU</i></p>
                <p>Project Github Page: <a href="https://github.com/Gananath/DrugAI/tree/master/DrugAI-WGAN">https://github.com/Gananath/DrugAI/tree/master/DrugAI-WGAN</a></p>
                <p>FloydHub logs: <a href="https://github.com/Gananath/DrugAI/blob/master/DrugAI-WGAN/floyd_logs.txt">https://github.com/Gananath/DrugAI/blob/master/DrugAI-WGAN/floyd_logs.txt</a></p>
               
                
                <h1 class="display-6 py-2">Helpful Links:</h1> 
                <ul class="list-group list-group-flush">
                  <li class="list-group-item">https://github.com/soumith/ganhacks</li>
                  <li class="list-group-item">https://medium.com/towards-data-science/gan-by-example-using-keras-on-tensorflow-backend-1a6d515a60d0</li>

                </ul>
                

          </div>
          
           <!-- Sidebar -->
          <div class="col-sm-3 bg-light">

                <a href="index.html"  class="btn btn-primary btn-block custom-btn mt-1 text-light" role="button">Home</a>
                <a href="prob_retrieval.html"  class="btn btn-primary btn-block custom-btn mt-1 text-light" role="button">Probabilistic Memory Retrieval</a>
                <a href="nerd.html"  class="btn btn-primary btn-block custom-btn mt-1 text-light" role="button">NERD</a>
                <a href="drugai.html"  class="btn btn-outline-primary text-secondary  btn-block custom-btn mt-1" role="button">DrugAI</a>
                <a href="proteinstatai.html"  class="btn btn-primary btn-block custom-btn mt-1 text-light" role="button">ProteinStatsAI</a>
                <a href="multi_task.html"  class="btn btn-primary btn-block custom-btn mt-1 text-light" role="button">BrainGAN</a>
                <a href="cv.html"  class="btn btn-primary btn-block custom-btn mt-1 text-light" role="button">CV</a>
                <a href="https://github.com/Gananath"  class="btn btn-primary btn-block custom-btn mt-1 text-light" role="button">Contact</a>


          
          </div>
        </div> 
    
  </div>
    
   <!-- Footer -->
    <div class="container mt-4 border-top bg-primary rounded-bottom">
      <footer class="py-3 my-4">
        <ul class="nav justify-content-center border-bottom pb-3 mb-3">
          <li class="nav-item"><a href="#" class="nav-link px-2 text-light">Footer</a></li>
        </ul>
        <p class="text-center text-light">Â© 2022 Made by Me</p>
      </footer>
    </div>

  </body>
</html>
