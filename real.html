<!DOCTYPE html>
<!--[if lt IE 7]>      <html class="no-js lt-ie9 lt-ie8 lt-ie7"> <![endif]-->
<!--[if IE 7]>         <html class="no-js lt-ie9 lt-ie8"> <![endif]-->
<!--[if IE 8]>         <html class="no-js lt-ie9"> <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js"> <!--<![endif]-->
    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">

        <title>Real: Real number generation using neural network classification.</title>
        <meta name="description" content="Classification of Drug Like molecules using Artificial Neural Network">
        <meta name="keywords" content="">

        <!-- Mobile viewport -->
        <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

        <link rel="shortcut icon" href="images/favicon.ico"  type="image/x-icon">

        <!-- CSS-->
        <!-- Google web fonts. You can get your own bundle at http://www.google.com/fonts. Don't forget to update the CSS accordingly!-->
        <link href='http://fonts.googleapis.com/css?family=Droid+Serif|Ubuntu' rel='stylesheet' type='text/css'>

        <link rel="stylesheet" href="css/normalize.css">
        <link rel="stylesheet" href="js/flexslider/flexslider.css">
        <link rel="stylesheet" href="css/colorblocks-style.css">

        <!-- end CSS-->

        <!-- JS-->
        <script src="js/libs/modernizr-2.6.2.min.js"></script>

         <!-- Math js-->
         
         <script type="text/x-mathjax-config">
    MathJax.Hub.Config({
      jax: ["input/TeX", "output/HTML-CSS"],
      extensions: ["tex2jax.js"],
      "HTML-CSS": { preferredFont: "TeX", availableFonts: ["STIX","TeX"] },
      tex2jax: { inlineMath: [ ["$", "$"], ["\\(","\\)"] ], displayMath: [ ["$$","$$"], ["\\[", "\\]"] ], processEscapes: true, ignoreClass: "tex2jax_ignore|dno" },
      TeX: { noUndefined: { attributes: { mathcolor: "red", mathbackground: "#FFEEEE", mathsize: "90%" } } },
      messageStyle: "none"
    });
    </script>    
    <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js"></script>
<!-- Math js-->
        <!-- end JS-->

    </head>

    <body id="home">


        <!-- header area -->
        <header class="wrapper clearfix">

            <div id="banner">        
                <div id="logo"><a href="index.html"><img src="images/logo.png" alt="logo"></a></div> 
            </div>

            <!-- main navigation -->
            <nav id="topnav" role="navigation">
                <div class="menu-toggle">Menu</div>  
                <ul class="srt-menu" id="menu-main-navigation">
                    <li ><a href="index.html">Home page</a></li>            
                    <li class="current"><a href="#">Projects</a>
                        <ul>
                            <li>
                                <a href="drugai.html">DrugAI</a>
                                <ul>
                                    <li><a href="drugai-gen.html">DrugAI-gen</a></li>
                                    <li><a href="drugai-gan.html">DrugAI-GAN</a></li>
                                </ul>
                            </li>
                            <li>
                                <a href="proteinstatai.html">ProteinStatsAI</a>
                            </li>
                            <li>
                                <a href="multi_task.html">BrainGAN</a>
                            </li>
                            <li>
                                <a href="nerd.html">NERD</a>
                            </li>
                            <li class="current">
                                <a href="real.html">Real</a>
                            </li> 
                            <li>
                                <a href="#">Others</a>
                                <ul>
                                    <li><a href="https://gist.github.com/Gananath/5b2f4640fdf96cd87a81a4206a0d3fe8">Kaggle</a></li>
                                    <li><a href="#">menu item 3.2.2 with longer link name</a></li>
                                    <li><a href="#">menu item 3.2.3</a></li>
                                    <li><a href="#">menu item 3.2.4</a></li>
                                    <li><a href="#">menu item 3.2.5</a></li>
                                </ul>
                            </li>                           
                        </ul>
                    </li>
                    <li>
                        <a href="cv.html" target="_blank">CV</a>
                    </li>
                    <li>
                        <a href="#">Contact</a>
                        <ul>
                            <li><a href="javascript: void(0)"
 onclick="return confirm('Msg me in github or reddit, preferably both.');">E-Mail</a></li>	
                            <li><a href="https://github.com/Gananath">GitHub</a></li>	
                            <li><a href="#">Facebook</a></li>	
                            <li><a href="#">Twitter</a></li>	
                        </ul>
                    </li>
                </ul>     
            </nav><!-- end main navigation -->

        </header><!-- end header -->



        <!-- hero area (the grey one with a slider -->
        <section id="page-header" class="clearfix">    

            <div class="wrapper">
                <h1>Real</h1>
                <h4>Real number generation using neural network classification.</h4>
            </div>
        </section><!-- end hero area -->





        <!-- main content area -->   

        <div id="main" class="wrapper clearfix">    

            <!-- content area -->    
            <section id="content">

                <p><b>Note:</b> This is a personal project of my own; I believe/assume this is an original work and similar work has not been carried out by anyone else.</p>
                <p>It seesm most people want to know what this used for; this is a comment I wrote in reddit</p>
                <p style="background-color:#B6ACAC"><i style="color:white">"I try to explain with a little example say we need to predict Partition coefficient of a chemical molecule. A partition coefficient(P) or Log P can take any real values both positive or negative eg: Acetamide= -1.16. If we want to predict such values for a chemical molecule in neural network then we have to use linear activation function as last layer and need to train it in a regression way, which may or may not succeed.
<br>
My idea is to avoid this step and predict real numbers as binary classification with a certain length. As an proof of my idea I made a auto encoder which was able to get a fair good but not the best predictions"</i></p>

                <p>There are two ways, that I know of, to generate real numbers using neural networks and those are the regression and seq2seq approaches. From experience I can say that both regression and recurrent(seq2seq) methods are computationally heavy and  I also assume the transformer(seq2seq) technique may also need more computation. In this project my goal was to generate real numbers using classification only approach with a simple neural network. The advantages of such method will be fast training and quick prediciton of outputs. An another novel application for this is building a neural network enabled calculator for deterministic real number operations.</p>
                
                <h2>Real to Vectors.</h2>
                <p>Real number in its real form cannot be used for a classification method. We need to convert real numbers to a binary vector form. First we need to separate real numbers into its three corresponding  <b>Sign</b>, <b>Integers</b> and <b>Decimal/Placeholder</b> parts. An example for such breakup can be seen in the below image.
                   
                <center><img src="images/real_example.jpg" alt="real_example" style="width:288px;height:235px;"> </center>  
                <br>
                
                The sign determining value $k$ can be found by
                <br><br>
                <center>$k =  argmax(softmax(\mathbb{R}^{2}))$</center>
                <br>
                For integers we need to first find the matching vector $\mathbf{i}$. The vector can then be transformed to a scalar $i$ by taking dot product with vector having list of values which are powers of 10. Here $d$ is the maximum integer length.
                <br><br>
                <center>$\mathbf{i} = argmax_{row}(softmax_{row}(\mathbb{R}^{d \times10}))$</center>
                <br>
                <center>$i =  \mathbf{i} \cdot   [10^{d..0} ]$</center>
                <br>
                The decimal's placeholder value $p$ which determines where the decimal should be placed in the integers can be obtained by 
                <br><br>
                <center>$p = argmax(softmax(\mathbb{R}^{d}))$</center>
                <br>
                In the end real numbers can be calculated using the formula.
                <br><br>
                <center>$\mathbb{R}= \left \{ (-1)^{k}\times i \times10^{-p} \right \}$</center>
                <br>
                <small><i>Note: I am mediocre in mathematics, kindly forgive any errors</i></small>
                </p>
                <h2>Neural Network.</h2>
                <p>
                A linear neural network was used for this project but any other varieties of neural network will also work. Because my primary aim was to validate my idea I had used a autoencoder model to generate real numbers. The autoencoder model has three input heads and three output heads. 
                
                <ul>
                    <li><p>Input Heads: Sign, Integers, Decimal</p>

                    </li>
                    <li><p>Output Heads: Sign, Integers, Decimal</p>

                    </li>
                </ul>
                
                The loss function used was a binary crossentropy loss for the three output heads plus a custom <b>difference loss</b> function. The difference loss function finds the difference between our target and output integers. This loss function in its current form is a non differentiable since it have argmax's in its computation. I was planning to make differentiable version of this loss function with softargmax but was not able to find a good implementation for the same in pytorch. 
                </p>
                
                <h2>Result</h2>

                <p> 
                   <br>
                Real:  [29.462 10.119 16.    54.483 81.462 77.     5.2   64.73  17.3   17.25 ]<br>
                Pred:  [52.462, 52.119, 16.0, 92.483, 52.462, 77.0, 5.2, 64.73, 17.3, 17.25]<br>
                Loss:  0.7908857719954486 <br><br>

                Real:  [77.97  48.1   51.95  25.358 71.813 21.05  92.2   84.6   61.4   51.272]<br>
                Pred:  [77.97, 48.1, 51.95, 49.358000000000004, 46.813, 21.05, 92.2, 84.60000000000001, 61.400000000000006, 29.272000000000002]<br>
                Loss:  0.27221214151122436<br><br>


                Real:  [49.9   62.75  51.209  2.33   0.2   45.3   24.188  7.83  23.14  75.9  ]<br>
                Pred:  [49.900000000000006, 62.75, 17.209, 2.33, 0.2, 45.300000000000004, 25.188, 7.83, 23.14, 75.9]<br>
                Loss:  0.35590826826738353<br><br>

                The outputs are very encouraging and neural network was able to predict majoririty of real numbers correctly. Loss function corresponding to Sign and Decimal output heads were optimized properly. But In my option the stochasticity of generated real numbers was due to the sub optimal loss functions used for integers head. A much more improved integer head loss function might increase the accuracy of prediction. Overfitting the model also helped to attain good predicitons, adding dropouts significantly affected the output results.
                    
                    
                </p>

                <p>Project Github Page: <a href="https://github.com/Gananath/Real">https://github.com/Gananath/Real</a></p>
                <br>
                <h2>Future Plans.</h2>
                <p>
                                    <ul>
                    <li><p>Improving the accuracy of prediction.</p> </li>
                    <li><p>Building a neural network calculator with this idea.</p></li>
                    <li><p>Posible application includes all the works which needs real numbers eg, velocity prediction, drug likeness prediciton etc.</p></li>
                </ul>
                    
                </p>
                
                

            </section><!-- #end content area -->


            <!-- sidebar -->    
            <aside>
                <h2>Navigation</h2>
                <nav id="secondary-navigation">
                    <ul>
                        <li><a href="index.html">Home Page</a></li>
                        <li class="current"><a href="real.html">Real</a></li>
                        <li><a href="nerd.html">NERD</a></li>
                        <li><a href="drugai.html">DrugAI</a></li>                        
                        <li><a href="proteinstatai.html">ProteinStatsAI</a></li>
                        <li><a href="multi_task.html">BrainGAN</a></li>
                        <li><a href="cv.html">CV</a></li>
                        <li><a href="https://github.com/Gananath">Contact</a></li>

                    </ul>
                </nav>
            </aside><!-- #end sidebar -->



        </div><!-- #end div #main .wrapper -->





        <!-- footer area -->    
        <footer>
            <div id="colophon" class="wrapper clearfix">
                footer stuff
            </div>

            <!--You can NOT remove this attribution statement from any page, unless you get the permission from prowebdesign.ro--><div id="attribution" class="wrapper clearfix" style="color:#666; font-size:11px;">Site built with <a href="http://www.prowebdesign.ro/simple-responsive-template/" target="_blank" title="Simple Responsive Template is a free software by www.prowebdesign.ro" style="color:#777;">Simple Responsive Template</a></div><!--end attribution-->

        </footer><!-- #end footer area --> 


        <!-- jQuery -->
        <script src="http://ajax.googleapis.com/ajax/libs/jquery/1/jquery.min.js"></script>
        <script>window.jQuery || document.write('<script src="js/libs/jquery-1.9.0.min.js">\x3C/script>')</script>

        <script defer src="js/flexslider/jquery.flexslider-min.js"></script>

        <!-- fire ups - read this file!  -->   
        <script src="js/main.js"></script>

    </body>
</html>
